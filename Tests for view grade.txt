select * from (select coursesubject, coursenumber from courses union select coursesubject, coursenumber from complementarycourses) as c where c.coursesubject = 'Engi'

select n.coursesubject,n.coursenumber,n.coursegrade from "0526298" as n,(select coursesubject, coursenumber from courses union select coursesubject, coursenumber from complementarycourses) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber

select avg(t.coursegrade), count(t.coursenumber) from (select n.coursesubject,n.coursenumber,n.coursegrade from "0526298" as n,(select coursesubject, coursenumber from courses union select coursesubject, coursenumber from complementarycourses) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber) as t

_____________________YEARSTUFF__BELOW__THIS__POINT_______________________________________________________________________________________________________________________________________________________________________________________________________________________________________________

select n.coursesubject,n.coursenumber,n.coursegrade from "0526298" as n,(select coursesubject, coursenumber ,year from courses union select coursesubject, coursenumber ,year from complementarycourses) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and c.year <= n.year order by coursenumber

NC deploma==> select count(*) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear ,lastusedyear,credits from courses where coursenumber::int<3000 union (select distinct m.coursesubject, m.coursenumber ,s.year,null::int,m.credits from makeupcourses as m,student as s where m.studentid = '0526298') ) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc) as final
NC degree==> select count(*) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from courses where coursenumber::int >=3000 union select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from complementarycourses) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc)as final
SA Deploma==> select avg(final.coursegrade * final.credits *2) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear ,lastusedyear,credits from courses where coursenumber::int<3000 union (select distinct m.coursesubject, m.coursenumber ,s.year,null::int,m.credits from makeupcourses as m,student as s where m.studentid = '0526298') ) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year = 2016 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc) as final
SA Degree==> select avg(final.coursegrade * final.credits *2) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from courses where coursenumber::int >=3000 union select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from complementarycourses) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year=2016 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc)as final
CA Deploma==> select avg(final.coursegrade * final.credits *2) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear ,lastusedyear,credits from courses where coursenumber::int<3000 union (select distinct m.coursesubject, m.coursenumber ,s.year,null::int,m.credits from makeupcourses as m,student as s where m.studentid = '0526298') ) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc) as final
CA Degree==> select avg(final.coursegrade * final.credits *2) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from courses where coursenumber::int >=3000 union select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from complementarycourses) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc)as final
D Deploma==> select count(*) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear ,lastusedyear,credits from courses where coursenumber::int<3000 union (select distinct m.coursesubject, m.coursenumber ,s.year,null::int,m.credits from makeupcourses as m,student as s where m.studentid = '0526298') ) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and(c.firstusedyear<=n.year and n.coursegrade>=50 and n.coursegrade<60 and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc) as final
F Deploma==> select count(*) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear ,lastusedyear,credits from courses where coursenumber::int<3000 union (select distinct m.coursesubject, m.coursenumber ,s.year,null::int,m.credits from makeupcourses as m,student as s where m.studentid = '0526298') ) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and(c.firstusedyear<=n.year and n.coursegrade<50 and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc) as final
D Degree==> select count(*) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from courses where coursenumber::int >=3000 union select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from complementarycourses) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and n.coursegrade >= 50 and n.coursegrade < 60 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc)as final
F Degree==> select count(*) from (select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from courses where coursenumber::int >=3000 union select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from complementarycourses) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and n.coursegrade < 50 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc)as final
SCA ==> select avg(final.coursegrade * final.credits * 2) from ((select distinct on (n.coursesubject,n.coursenumber) n.coursesubject,n.coursenumber,n.coursegrade ,c.credits from "0526298" as n,(select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from courses union select coursesubject, coursenumber ,firstusedyear,lastusedyear ,credits from complementarycourses union (select distinct m.coursesubject, m.coursenumber ,s.year,null::int,m.credits from makeupcourses as m,student as s where m.studentid = '0526298') ) as c where c.coursesubject=n.coursesubject and c.coursenumber = n.coursenumber and n.year<=2016 and(c.firstusedyear<=n.year and (c.lastusedyear>=n.year or c.lastusedyear is null)) order by n.coursesubject, n.coursenumber, n.year desc )union select coursesubject,coursenumber,coursegrade,0.5 from "0526298" )as final

FINDALLYEARSWITHGRADES==>select distinct yearsection from "0526298" order by yearsection asc

ONLYSELECTSMOSTRECENTGRADE==>select distinct on (coursesubject,coursenumber) coursesubject,coursenumber,coursegrade, year from "0526298" order by coursesubject,coursenumber, year desc




